<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Teklif {{ offer_id }}</title>
<style>
@page { size: A4; margin: 8mm; }
@media print { html, body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: Arial, sans-serif; font-size: 8.5pt; line-height: 1.3; color: #333; }
.header { display: flex; justify-content: space-between; align-items: flex-start; border-top: 3px solid #4B5563; padding: 5px 0 10px 0; margin-bottom: 8px; overflow: visible; min-height: 50px; }
.logo { display: flex; align-items: flex-start; gap: 10px; }
.logo-icon { width: 40px; height: 40px; background: #4B5563; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #F59E0B; font-size: 20px; flex-shrink: 0; }
.brand-text { display: inline-block; line-height: 1.35; }
.company-name { font-size: 20pt; font-weight: bold; color: #374151; line-height: 1.1; }
.company-sub { font-size: 12pt; font-style: italic; color: #F59E0B; display: inline-block; line-height: 1.5; padding-bottom: 5px; }
.header-right { display: flex; gap: 12px; align-items: flex-start; text-align: right; }
.header-info { font-size: 9pt; line-height: 1.5; }
.stripes { display: flex; flex-direction: column; gap: 4px; }
.stripe { width: 55px; height: 12px; background: #F59E0B; transform: skewX(-15deg); }
.stripe:nth-child(2) { margin-left: 6px; }
.stripe:nth-child(3) { margin-left: 12px; }
.title { text-align: center; font-size: 11pt; font-style: italic; border-bottom: 2px solid #10B981; padding: 5px 0; margin-bottom: 8px; }
.intro { margin-bottom: 8px; line-height: 1.4; }
table { width: 100%; border-collapse: collapse; margin-bottom: 8px; font-size: 8pt; break-inside: avoid; }
th, td { padding: 5px 6px; border: 1px solid #ddd; }
th { background: #f5f5f5; text-align: left; font-weight: 600; }
.cmp th { background: #10B981; color: white; text-align: center; }
.cmp td { text-align: right; }
.cmp td:first-child { text-align: left; }
.total { background: #e8f5e9 !important; font-weight: bold; }
.save { background: #10B981; color: white; padding: 10px; border-radius: 6px; text-align: center; margin: 10px 0; }
.save .label { font-size: 7pt; }
.save .amt { font-size: 14pt; font-weight: bold; }
.terms { background: #f9f9f9; border-left: 3px solid #10B981; padding: 8px 10px; margin: 8px 0; font-size: 8pt; }
.terms-title { font-size: 10pt; font-weight: bold; color: #1F2937; margin-bottom: 5px; }
.sig { margin-top: 10px; font-size: 8pt; }
.foot { margin-top: 10px; padding-top: 5px; border-top: 1px solid #ddd; font-size: 7pt; color: #888; text-align: center; }
</style>
</head>
<body>
<div class="header">
<div class="logo">
<div class="logo-icon">⚡</div>
<div class="brand-text"><div class="company-name">GELKA</div><div class="company-sub">enerji</div></div>
</div>
<div class="header-right">
<div class="header-info"><strong>Teklif No:</strong> {{ offer_id }}<br><strong>Tarih:</strong> {{ date }}</div>
<div class="stripes"><div class="stripe"></div><div class="stripe"></div><div class="stripe"></div></div>
</div>
</div>
<div class="title">Enerji Tasarruf Teklifi</div>
<p class="intro"><strong>{{ greeting }}</strong><br>Mevcut elektrik tüketim verileriniz ve tarafımıza iletilen fatura bilgileriniz esas alınarak yapılan analiz sonucunda, {{ tariff_group }} abone grubunuz için hazırlanan elektrik enerjisi tedarik teklifimizi bilgilerinize sunarız.</p>
{% if customer_name or contact_person %}
<table style="margin-bottom: 8px;">
<tr><th style="width:15%">Firma Adı</th><td style="width:35%">{{ customer_name or '-' }}</td><th style="width:15%">Yetkili Kişi</th><td style="width:35%">{{ contact_person or '-' }}</td></tr>
</table>
{% endif %}
<table class="cmp">
<tr><th style="width:28%">Kalem</th><th style="width:24%">Mevcut</th><th style="width:24%">Teklif</th><th style="width:24%">Tasarruf</th></tr>
<tr><td>Enerji Bedeli</td><td>{{ calc.current_energy_tl | currency }}</td><td>{{ calc.offer_energy_tl | currency }}</td><td>{{ (calc.current_energy_tl - calc.offer_energy_tl) | currency }}</td></tr>
<tr><td>Dağıtım Bedeli</td><td>{{ calc.current_distribution_tl | currency }}</td><td>{{ calc.offer_distribution_tl | currency }}</td><td>-</td></tr>
<tr><td>BTV</td><td>{{ calc.current_btv_tl | currency }}</td><td>{{ calc.offer_btv_tl | currency }}</td><td>-</td></tr>
<tr><td>KDV Matrahı</td><td>{{ calc.current_vat_matrah_tl | currency }}</td><td>{{ calc.offer_vat_matrah_tl | currency }}</td><td>-</td></tr>
<tr><td>KDV (%{{ (calc.meta_vat_rate * 100) | int if calc.meta_vat_rate else 20 }})</td><td>{{ calc.current_vat_tl | currency }}</td><td>{{ calc.offer_vat_tl | currency }}</td><td>-</td></tr>
<tr class="total"><td>TOPLAM</td><td>{{ calc.current_total_with_vat_tl | currency }}</td><td>{{ calc.offer_total_with_vat_tl | currency }}</td><td>{{ calc.difference_incl_vat_tl | currency }}</td></tr>
</table>
<div class="save"><div class="label">Aylık Tasarruf</div><div class="amt">{{ calc.difference_incl_vat_tl | currency }} ({{ calc.savings_ratio | percent }})</div></div>
<table>
<tr><th>Ağırlıklı PTF</th><td>{{ weighted_ptf | number(2) }} TL/MWh</td><th>YEKDEM</th><td>{{ yekdem | number(2) }} TL/MWh</td></tr>
<tr><th>Anlaşma Çarpanı</th><td>{{ agreement_multiplier | number(2) }}</td><th>Teklif Birim Fiyat</th><td>{{ offer_unit_price | number(4) }} TL/kWh</td></tr>
<tr><th>Mevcut Birim Fiyat</th><td>{{ current_unit_price | number(4) }} TL/kWh</td><th>Birim Fiyat Farkı</th><td>{{ (current_unit_price - offer_unit_price) | number(4) }} TL/kWh</td></tr>
</table>
<p style="font-size: 7.5pt; margin-bottom: 4px;"><strong>Fatura Bilgileri</strong></p>
<table style="margin-bottom: 8px;">
<tr><th>Tedarikçi</th><td>{{ vendor or 'Manuel Giriş' }}</td><th>Dönem</th><td>{{ invoice_period or '-' }}</td></tr>
<tr><th>Tüketim</th><td>{{ consumption_kwh | number }} kWh</td><th>Tarife Grubu</th><td>{{ tariff_group }}</td></tr>
</table>
<div class="terms"><div class="terms-title">Ticari Şartlar</div>✓ Fatura vadesi +10 gün ✓ Teminat yok ✓ Güvence yok</div>
<div class="sig">{% if contact_person %}İlgili: {{ contact_person }}<br>{% endif %}Bilgilerinize sunarız.<br>Saygılarımızla,<br><strong>Gelka Enerji</strong></div>
<div class="foot">Teklif No: {{ offer_id }} | {{ date }} | Geçerlilik: {{ offer_validity_days }} Gün | www.gelkaenerji.com.tr</div>
</body>
</html>
